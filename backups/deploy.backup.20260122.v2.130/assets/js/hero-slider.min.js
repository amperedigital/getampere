(()=>{"use strict";const t="[data-hero-slider]",e="[HeroSlider]",i=768,s=(...t)=>console.log(e,...t);class a{constructor(t){this.slider=t,this.dataset=t.dataset||{},this.initialized=!1,this.config={autoDelay:Number(this.dataset.autoDelay)||5e3,autoDuration:Number(this.dataset.autoDuration)||1800,resumeDelay:Number(this.dataset.resumeDelay)||5e3,retryDelay:Number(this.dataset.retryDelay)||500,momentumFriction:Math.min(Math.max(Number(this.dataset.momentumFriction)||.985,.8),.999),momentumStep:Number(this.dataset.momentumStep)||12},this.state={pointerActive:!1,lastX:0,lastTime:0,velocity:0,isHover:!1,autoTimer:null,resumeTimer:null,animFrame:null,momentumFrame:null},this.handlePointerDown=this.handlePointerDown.bind(this),this.handlePointerMove=this.handlePointerMove.bind(this),this.handlePointerUp=this.handlePointerUp.bind(this),this.handlePointerCancel=this.handlePointerCancel.bind(this),this.handleMouseEnter=this.handleMouseEnter.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this),this.handleVisibility=this.handleVisibility.bind(this),this.handleBlur=this.handleBlur.bind(this),this.handleFocus=this.handleFocus.bind(this),this.step=this.step.bind(this)}init(){this.initialized||(this.slider.addEventListener("pointerdown",this.handlePointerDown),this.slider.addEventListener("pointermove",this.handlePointerMove),this.slider.addEventListener("pointerup",this.handlePointerUp),this.slider.addEventListener("pointercancel",this.handlePointerCancel),this.slider.addEventListener("mouseenter",this.handleMouseEnter),this.slider.addEventListener("mouseleave",this.handleMouseLeave),document.addEventListener("visibilitychange",this.handleVisibility),window.addEventListener("blur",this.handleBlur,{passive:!0}),window.addEventListener("focus",this.handleFocus,{passive:!0}),s("Initialized (Desktop Mode)",this.slider.id?`#${this.slider.id}`:""),this.scheduleAuto(this.config.autoDelay),this.initialized=!0)}destroy(){this.initialized&&(this.stopAuto(),this.cancelMomentum(),this.state.resumeTimer&&clearTimeout(this.state.resumeTimer),this.slider.removeEventListener("pointerdown",this.handlePointerDown),this.slider.removeEventListener("pointermove",this.handlePointerMove),this.slider.removeEventListener("pointerup",this.handlePointerUp),this.slider.removeEventListener("pointercancel",this.handlePointerCancel),this.slider.removeEventListener("mouseenter",this.handleMouseEnter),this.slider.removeEventListener("mouseleave",this.handleMouseLeave),document.removeEventListener("visibilitychange",this.handleVisibility),window.removeEventListener("blur",this.handleBlur),window.removeEventListener("focus",this.handleFocus),this.slider.classList.remove("is-dragging"),s("Destroyed (Mobile Mode)",this.slider.id?`#${this.slider.id}`:""),this.initialized=!1)}clamp(t,e,i){return Math.min(Math.max(t,e),i)}getStepDistance(){const t=this.slider.children;if(!t||0===t.length)return this.slider.clientWidth||0;let e=t[0].getBoundingClientRect().width,i=0;for(let s=1;s<t.length;s+=1){const a=Math.abs(t[s].offsetLeft-t[0].offsetLeft)||0;if(a>0){i=a;break}}return i||e||this.slider.clientWidth||0}stopAuto(){this.state.autoTimer&&(window.clearTimeout(this.state.autoTimer),this.state.autoTimer=null),this.state.animFrame&&(window.cancelAnimationFrame(this.state.animFrame),this.state.animFrame=null)}scheduleAuto(t=this.config.autoDelay){this.stopAuto(),this.slider.scrollWidth<=this.slider.clientWidth+4||(this.state.autoTimer=window.setTimeout(()=>this.runAuto(),t))}pauseAuto(){this.stopAuto(),this.state.resumeTimer&&(window.clearTimeout(this.state.resumeTimer),this.state.resumeTimer=null)}runAuto(){if(this.state.pointerActive||this.state.isHover)return void this.scheduleAuto(this.config.retryDelay);const t=this.slider.scrollWidth-this.slider.clientWidth,e=this.slider.scrollLeft+this.getStepDistance(),i=e>=t-1?0:this.clamp(e,0,t);this.animateScrollTo(i)}animateScrollTo(t){this.stopAuto();const e=this.slider.scrollLeft,i=t-e,s=this.config.autoDuration;let a=null;const n=t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2;this.animationContext={start:e,distance:i,duration:s,startTime:a,ease:n,target:t},this.state.animFrame=window.requestAnimationFrame(this.step)}step(t){const e=this.animationContext;if(e){null===e.startTime&&(e.startTime=t);const i=t-e.startTime,s=this.clamp(i/e.duration,0,1);this.slider.scrollLeft=e.start+e.distance*e.ease(s),s<1?this.state.animFrame=window.requestAnimationFrame(this.step):(this.slider.scrollLeft=e.target,this.scheduleAuto(this.config.autoDelay))}}alignToNearestStep(){const t=this.getStepDistance();if(!t)return!1;const e=this.slider.scrollWidth-this.slider.clientWidth,i=this.slider.scrollLeft,s=this.clamp(Math.round(i/t)*t,0,e);return!(Math.abs(s-i)<1)&&(this.animateScrollTo(s),!0)}resumeAutoDelayed(t=this.config.resumeDelay){this.state.resumeTimer&&window.clearTimeout(this.state.resumeTimer),this.state.resumeTimer=window.setTimeout(()=>{if(!this.state.pointerActive&&!this.state.isHover){this.alignToNearestStep()||this.scheduleAuto()}},t)}cancelMomentum(){this.state.momentumFrame&&(window.cancelAnimationFrame(this.state.momentumFrame),this.state.momentumFrame=null)}startMomentum(){this.cancelMomentum();const t=this.slider.scrollWidth-this.slider.clientWidth;if(!isFinite(this.state.velocity)||Math.abs(this.state.velocity)<.001)return void this.resumeAutoDelayed();let e=this.state.velocity*(1e3/60)*this.config.momentumStep;const i=()=>{this.slider.scrollLeft=this.clamp(this.slider.scrollLeft-e,0,t),e*=this.config.momentumFriction,Math.abs(e)>.3?this.state.momentumFrame=window.requestAnimationFrame(i):(this.cancelMomentum(),this.resumeAutoDelayed())};this.state.momentumFrame=window.requestAnimationFrame(i)}handlePointerDown(t){t.isPrimary&&(this.state.pointerActive=!0,this.slider.classList.add("is-dragging"),this.slider.setPointerCapture(t.pointerId),this.state.lastX=t.clientX,this.state.lastTime=t.timeStamp,this.state.velocity=0,this.pauseAuto(),this.cancelMomentum())}handlePointerMove(t){if(this.state.pointerActive){t.preventDefault();const e=t.clientX-this.state.lastX;this.slider.scrollLeft-=e;const i=t.timeStamp-this.state.lastTime||16;this.state.velocity=e/i,this.state.lastX=t.clientX,this.state.lastTime=t.timeStamp}}handlePointerUp(t){this.state.pointerActive&&(this.state.pointerActive=!1,this.slider.classList.remove("is-dragging"),this.slider.releasePointerCapture(t.pointerId),this.startMomentum())}handlePointerCancel(t){this.state.pointerActive&&(this.state.pointerActive=!1,this.slider.classList.remove("is-dragging"),this.slider.releasePointerCapture(t.pointerId),this.resumeAutoDelayed())}handleMouseEnter(){this.state.isHover=!0,this.pauseAuto()}handleMouseLeave(){this.state.isHover=!1,this.resumeAutoDelayed()}handleVisibility(){document.hidden?this.pauseAuto():this.resumeAutoDelayed(this.config.retryDelay)}handleBlur(){this.pauseAuto()}handleFocus(){this.resumeAutoDelayed(this.config.retryDelay)}}const n=[],r=()=>{const t=window.innerWidth<i;n.forEach(e=>{t?e.destroy():e.init()})},o=t=>{"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t,{once:!0}):t()};o(()=>{const e=document.querySelectorAll(t);e.length?(e.forEach(t=>{n.push(new a(t))}),r(),(() => { let t; window.addEventListener("resize",()=>{ clearTimeout(t),t=setTimeout(r,250) }) })()) : s("No slider instances found.")})})();
